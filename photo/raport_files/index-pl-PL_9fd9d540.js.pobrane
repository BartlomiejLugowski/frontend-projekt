/*! For license information please see index-pl-PL_9fd9d540.js.LICENSE.txt */
!function(e,t){for(var n in t)e[n]=t[n]}(window,function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="https://assets.allegrostatic.com/sc-12731/",n(n.s=0)}({0:function(e,t,n){e.exports=n("WdQY")},Jmsw:function(e){e.exports=JSON.parse('{"a":"https://assets.allegrostatic.com/metrum/icon/arrow-f0934b0f84.svg","b":"https://assets.allegrostatic.com/metrum/icon/x-1a6f095eb2.svg"}')},WdQY:function(e,t,n){"use strict";n.r(t);var r=n("rRL6"),i=n.n(r);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function h(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function l(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var d=function(e){return"SUGGESTION"===e.type},v=function(e){return'[data-role="'.concat(e,'"]')},f=v("advanced-search-criteria"),g=v("filters-dropdown-toggle"),p=v("filters-selected-option"),m=v("multisearch-button"),y=v("multisearch-button-wrapper"),S=v("remove-query"),E=v("remove-recently-searched"),k=v("rewrite-recently-searched"),I=v("search-button"),b=v("search-form"),w=v("search-input"),L=v("suggester"),_=(v("suggestion"),"click"),N="submit",C=function(){return{events:{},emit:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];(this.events[e]||[]).forEach((function(e){return e.apply(void 0,n)}))},on:function(e,t){var n=this;return(this.events[e]=this.events[e]||[]).push(t),function(){return n.events[e]=(n.events[e]||[]).filter((function(e){return e!==t}))}}}},x={ActiveSuggestionIndex:"activeSuggestionIndex",NextPhrase:"nextPhrase",Suggestions:"suggestions",Tracking:"tracking",InputPhrase:"inputPhrase",SelectedFilterIndex:"selectedFilterIndex",CheckedAdvancedSearchCriteriaIds:"checkedAdvancedSearchCriteriaIds"},A=function(e){var t,n=e.inputPhrase,r=e.filters,i=void 0===r?{list:[],selected:0}:r,s=e.advancedSearchCriterias,o=void 0===s?[]:s;return{activeSuggestionIndex:-1,inputPhrase:n,nextPhrase:n,selectedFilterIndex:null!==(t=i.selected)&&void 0!==t?t:0,suggestions:[],tracking:{},checkedAdvancedSearchCriteriaIds:o.filter((function(e){return e.checked})).map((function(e){return e.id}))}},O=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:C();s(this,e),this.props=t,this.emitter=n,this.state=A(t)}return a(e,[{key:"on",value:function(){var e;return(e=this.emitter).on.apply(e,arguments)}}]),e}();function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,s=[],o=!0,a=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(s.push(r.value),!t||s.length!==t);o=!0);}catch(e){a=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(a)throw i}}return s}}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}Object.values(x).forEach((function(e){return Object.defineProperty(O.prototype,e,{get:function(){return this.state[e]},set:function(t){this.state=Object.assign({},this.state,u({},e,t)),this.emitter.emit(e,this.state)}})}));var T=function(e){return!!e&&!!e.type};function R(e,t){return[].concat(l(e.filter((function(e){return!t.includes(e)}))),l(t.filter((function(t){return!e.includes(t)}))))}function j(e,t,n){var r=n.filters.list[t.selectedFilterIndex];return!!T(r)&&e.includes(r.type)}function U(e,t){return!t.enableSuggestionsForEmptyPhrase&&function(e){return""===e}(e)}var G=["CHARITY_GOAL_OFFERS"],D=["ENDED","USERS","CHARITY_GOALS","CHARITY_ORGANIZATIONS"];function z(e,t){return j(D,e,t)||!t.advancedSearchCriterias.length}var B=function(e,t){return e.reduce((function(e,n){var r=P(e,2),i=r[0],s=r[1],o=n.queryParameter,a=n.id;return t.includes(a)?i.push(o):s.push(o),[i,s]}),[[],[]])},F=function(e,t){t?(e.classList.add("mpof_z0"),e.classList.remove("mpof_5r")):(e.classList.add("mpof_5r"),e.classList.remove("mpof_z0"))},M=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(r||e[t]!==n)&&(e[t]=n)},W=function(e,t){M(e,x.InputPhrase,t)},q=function(e,t){M(e,x.NextPhrase,t,!0)},K=function(e,t){M(e,x.CheckedAdvancedSearchCriteriaIds,t)},H=function(e){return{type:e.type,id:e.id}},Y=function(e){var t=e.filter(d).find((function(e){return"AD"===e.tracking.type}));return t?t.tracking.campaignId:null},V=function(e){return e.filter(d).reduce((function(e,t){var n=t.tracking.type;return e.types[n]?e.types[n]+=1:e.types[n]=1,e.count+=1,e}),{types:{},count:0})},Z=function(){function e(t,n,r){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window;s(this,e),u(this,"previousHash",""),u(this,"stateUnbinders",[]),u(this,"suggesterUnbinders",[]),u(this,"onSuggesterClickSuggestion",(function(e){i.sendSuggestHintClickEvent(e)})),u(this,"onSuggesterToggleExpanded",(function(e){i.sendSuggestLayerViewEvent(e)})),u(this,"onSuggesterReceivedSuggestions",(function(e){i.sendSuggestionsShowEvent(e)})),u(this,"onSuggesterClickRemoveSuggestion",(function(e){i.sendSuggestionRemoveClickEvent(e)})),u(this,"onSuggesterClickRewriteSuggestion",(function(e){i.sendRewriteClickEvent(e)})),u(this,"sendScopeChangeEvent",(function(e){var t=e.selectedFilterIndex,n={scope:H(i.filtersList[t]),previousScope:H(i.filtersList[i.previousSelectedFilterIndex])};i.targetWindow.opbox.analytics.sendBoxInteractionEvent({contextNode:i.searchInputNode,label:"scopeChange",customParams:n}),i.previousSelectedFilterIndex=t})),u(this,"sendSuggestionsShowEvent",(function(e){var t=Object.assign({status:e,typedPhrase:i.store.inputPhrase.trim(),suggestions:V(i.store.suggestions),scope:H(i.filtersList[i.store.selectedFilterIndex])},i.store.tracking),n=Y(i.store.suggestions);n&&(t.campaignId=n),i.targetWindow.opbox.analytics.sendItemViewEvent({contextNode:i.searchInputNode,label:"suggestionsShow",customParams:t}),i.sendAdsDSSSuggestionsShowEvents()})),u(this,"sendAdsDSSSuggestionsShowEvents",(function(){i.store.suggestions.filter(d).filter((function(e){return"PREMIUMAD"===e.tracking.type})).forEach((function(e){var t={analyticsId:e.tracking.emissionUnitId,analyticsEmissionTimestamp:e.tracking.timestamp,analyticsSignature:e.tracking.sig};i.targetWindow.opbox.analytics.sendItemViewEvent({contextNode:i.searchInputNode,label:"showDSSItems",customParams:t})}))})),u(this,"sendAdvancedSearchCheckedEvent",(function(e){var t=e.checkedAdvancedSearchCriteriaIds,n=R(t,i.previousCheckedAdvancedSearchCriteriaIds)[0];i.targetWindow.opbox.analytics.sendBoxInteractionEvent({contextNode:i.searchInputNode,label:"advancedSearchCriteria",value:t.includes(n).toString(),customParams:{id:n}}),i.previousCheckedAdvancedSearchCriteriaIds=l(t)})),this.baseNode=t,this.store=n,this.props=r,this.targetWindow=o,this.searchFormNode=t.querySelector(b),this.searchInputNode=t.querySelector(w),this.searchButtonNode=t.querySelector(I),this.filtersList=r.filters.list,this.previousCheckedAdvancedSearchCriteriaIds=l(n.checkedAdvancedSearchCriteriaIds),this.previousSelectedFilterIndex=this.store.selectedFilterIndex}return a(e,[{key:"mount",value:function(e){this.addEventListeners(),this.addStateListeners(),this.addSuggesterListeners(e)}},{key:"unmount",value:function(){this.removeEventListeners(),this.removeStateListeners(),this.removeSuggesterListeners()}},{key:"addEventListeners",value:function(){this.searchFormNode.addEventListener(N,this),this.searchInputNode.addEventListener("keydown",this),this.searchButtonNode.addEventListener("keydown",this),this.searchButtonNode.addEventListener("mousedown",this)}},{key:"removeEventListeners",value:function(){this.searchFormNode.removeEventListener(N,this),this.searchInputNode.removeEventListener("keydown",this),this.searchButtonNode.removeEventListener("keydown",this),this.searchButtonNode.removeEventListener("mousedown",this)}},{key:"addStateListeners",value:function(){this.stateUnbinders.push(this.store.on(x.SelectedFilterIndex,this.sendScopeChangeEvent),this.store.on(x.CheckedAdvancedSearchCriteriaIds,this.sendAdvancedSearchCheckedEvent))}},{key:"addSuggesterListeners",value:function(e){this.suggesterUnbinders.push(e.on("CLICK_SUGGESTION",this.onSuggesterClickSuggestion),e.on("TOGGLE_IS_EXPANDED",this.onSuggesterToggleExpanded),e.on("RECEIVE_SUGGESTIONS",this.onSuggesterReceivedSuggestions),e.on("CLICK_REMOVE_SUGGESTION",this.onSuggesterClickRemoveSuggestion),e.on("CLICK_REWRITE_SUGGESTION",this.onSuggesterClickRewriteSuggestion))}},{key:"removeStateListeners",value:function(){this.stateUnbinders.forEach((function(e){return e()}))}},{key:"removeSuggesterListeners",value:function(){this.suggesterUnbinders.forEach((function(e){return e()}))}},{key:"handleEvent",value:function(e){e.type===N&&this.onSubmit(),"keydown"===e.type&&"Enter"===e.key&&this.sendSearchInteraction(e),"mousedown"===e.type&&this.sendSearchInteraction(e)}},{key:"onSubmit",value:function(){if(-1!==this.store.activeSuggestionIndex){var e=this.store.suggestions.filter(d)[this.store.activeSuggestionIndex];this.sendSuggestHintClickEvent(e)}}},{key:"sendSuggestLayerViewEvent",value:function(e){if(e){var t={typedPhrase:this.store.inputPhrase.trim()};this.targetWindow.opbox.analytics.sendItemViewEvent({contextNode:this.searchInputNode,label:"suggestLayerView",customParams:t})}}},{key:"sendSuggestHintClickEvent",value:function(e){var t="".concat(e.tracking.type,"_REDIRECT"),n=Object.assign({typedPhrase:this.store.inputPhrase.trim(),details:Object.assign({phrase:e.completionText},e.tracking)},this.store.tracking);this.targetWindow.opbox.analytics.sendBoxInteractionEvent({contextNode:this.searchInputNode,label:"suggestHintClick",value:t,customParams:n})}},{key:"sendSearchInteraction",value:function(e){var t,n="keydown"===e.type?"searchEnter":"searchClick",r={typedPhrase:this.store.inputPhrase.trim(),scope:H(null!==(t=this.filtersList[this.store.selectedFilterIndex])&&void 0!==t?t:{})};this.targetWindow.opbox.analytics.sendBoxInteractionEvent({contextNode:this.searchInputNode,label:n,customParams:r})}},{key:"sendSuggestionRemoveClickEvent",value:function(e){var t="".concat(e.tracking.type,"_REMOVE"),n=Object.assign({typedPhrase:this.store.inputPhrase.trim(),details:Object.assign({phrase:e.completionText},e.tracking)},this.store.tracking);this.targetWindow.opbox.analytics.sendBoxInteractionEvent({contextNode:this.searchInputNode,label:"suggestionRemoveClick",value:t,customParams:n})}},{key:"sendRewriteClickEvent",value:function(e){var t="".concat(e.tracking.type,"_REWRITE"),n=Object.assign({typedPhrase:this.store.inputPhrase.trim(),details:Object.assign({phrase:e.completionText},e.tracking)},this.store.tracking);this.targetWindow.opbox.analytics.sendBoxInteractionEvent({contextNode:this.searchInputNode,label:"suggestRewriteClick",value:t,customParams:n})}}]),e}();function $(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var J={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#x27;"},Q=/<|>|&|"|'/g,X=(RegExp(Array.from("javascript:",(function(e){return"".concat(e).concat("[\\n\\r\\t]*")})).join(""),"ig"),function(e){return J[e]}),ee=function(){function e(t,n){s(this,e),this.$=t[0];for(var r=0;r<n.length;r++){var i=n[r];if(Array.isArray(i))for(var o=0;o<i.length;o++)this.$esc(i[o]);else this.$esc(i);this.$+=t[r+1]}}return a(e,[{key:"$esc",value:function(t){this.$+=t instanceof e?t.$:(t+"").replace(Q,X)}},{key:"toString",value:function(){return this.$}}]),e}(),te=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new ee(e,n)},ne={"pl-PL":{"Kategoria i opcje wyszukiwania":[["",["Kategoria i opcje wyszukiwania"]]],"Wszystkie kategorie":[["",["Wszystkie kategorie"]]],"Zakończone":[["",["Zakończone"]]],"Wszędzie":[["",["Wszędzie"]]],Sprzedawcy:[["",["Sprzedawcy"]]],Kategorie:[["",["Kategorie"]]],"Inne opcje":[["",["Inne opcje"]]],"Organizacje charytatywne":[["",["Organizacje charytatywne"]]],"Cele charytatywne":[["",["Cele charytatywne"]]],"czego szukasz?":[["",["czego szukasz?"]]],szukaj:[["",["szukaj"]]],"USUŃ":[["",["Usuń podpowiedź z histori"]]],"Cofnij do widoku strony":[["",["Cofnij do widoku strony"]]],"szukaj wielu":[["",["szukaj wielu"]]],Anuluj:[["",["Anuluj"]]],"Dom i Ogród":[["",["Dom i Ogród"]]],Dziecko:[["",["Dziecko"]]],Elektronika:[["",["Elektronika"]]],"Firma i usługi":[["",["Firma i usługi"]]],"Kolekcje i sztuka":[["",["Kolekcje i sztuka"]]],"Kultura i rozrywka":[["",["Kultura i rozrywka"]]],Moda:[["",["Moda"]]],Motoryzacja:[["",["Motoryzacja"]]],"Nieruchomości":[["",["Nieruchomości"]]],"Sport i turystyka":[["",["Sport i turystyka"]]],Supermarket:[["",["Supermarket"]]],Uroda:[["",["Uroda"]]],Zdrowie:[["",["Zdrowie"]]]}},re=/({{[^}]+}}|{%[^%}]+%})/g,ie=/({{[^}]+}})/g,se=/({%[^%}]+%})/g,oe=/({{\s*|\s*}}|{%\s*|\s*%})/g;function ae(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if("string"==typeof e)throw Error("Translation has to be an array");return e.find((function(e){return e[0]===t}))[1]}var ue,ce,he=function(e,t,n){var r=ne["pl-PL"][e];if(!r)throw Error('Missing translation for lang "pl-PL" and key "'.concat(e,'"'));return t?function(e,t,n){var r=ae(e,t.context);return function(e,t,n){if(n){var r=0;return e.split(re).map((function(n){if(n.match(se)){var i=t.formatters[r];if(i)return r+=1,i(n.replace(oe,""));throw Error('Missing translation formatter for "'.concat(e,'"'))}return n.match(ie)?t[n.replace(oe,"")]:n}))}var i=e.match(re),s=0;return i?i.reduce((function(n,r){var i=r.replace(oe,"");if(r.match(se)){var o=t.formatters[s];if(o)return s+=1,n.replace(r,o(i));throw Error('Missing translation formatter for "'.concat(e,'"'))}return r.match(ie)?n.replace(r,t[i]):n}),e):e}(r=parseInt(t.count,10)>=0?function(e,t){var n,r=1==(n=t)?0:n%10>=2&&n%10<=4&&(n%100<10||n%100>=20)?1:2;return"boolean"!=typeof r?e[r]:e[r?1:0]}(r,t.count):P(r,1)[0],t,n)}(r,t,n):ae(r)[0]},le=function(){function e(t,n,r){s(this,e),u(this,"stateUnbinders",[]),this.store=n,this.dropdownToggleNode=t.querySelector(g),this.selectedOptionNode=t.querySelector(p),this.filtersList=r.filters.list}return a(e,[{key:"mount",value:function(){this.addStateListeners(),this.addEventListeners(),this.updateSelectedFilter(this.dropdownToggleNode)}},{key:"unmount",value:function(){this.removeEventListeners(),this.removeStateListeners()}},{key:"addEventListeners",value:function(){this.dropdownToggleNode.addEventListener("change",this)}},{key:"removeEventListeners",value:function(){this.dropdownToggleNode.removeEventListener("change",this)}},{key:"addStateListeners",value:function(){var e=this;this.stateUnbinders.push(this.store.on(x.SelectedFilterIndex,(function(t){return e.handleSelectedFilterIndexChange(t)})))}},{key:"removeStateListeners",value:function(){this.stateUnbinders.forEach((function(e){return e()}))}},{key:"handleEvent",value:function(e){"change"===e.type&&this.onChange(e)}},{key:"handleSelectedFilterIndexChange",value:function(e){var t,n,r=e.selectedFilterIndex,i=null!==(t=this.filtersList[r])&&void 0!==t?t:this.filtersList[0];this.selectedOptionNode.innerHTML=(n=i.name)?he("Wszystkie kategorie")===n?te(ue||(ue=$(['<span class="','">','</span><span class="','">',"</span>"])),"mpof_z0 mpof_5r_x",he("Wszędzie"),"mpof_5r mpof_z0_x",n):te(ce||(ce=$(["",""])),n):""}},{key:"onChange",value:function(e){var t=e.target;this.updateSelectedFilter(t)}},{key:"updateSelectedFilter",value:function(e){var t,n=e.value,r=this.filtersList.findIndex((function(e){return e.url===n}));t=this.store,M(t,x.SelectedFilterIndex,r)}}]),e}(),de={"allegro-pl":"/listing","allegro-cz":"/vyhledavani"},ve=["p","us_id","string","description","show-raty0-disclaimer","fromCart"],fe=function(e,t){return t.some((function(t){return r=e,(n=t).key===r.key&&n.value===r.value;var n,r}))},ge=function(e,t){return fe(t,e)?e:[].concat(l(e),[t])},pe=function(e){return[e.key,e.value].map(encodeURIComponent).join("=")},me=function(e){return function(t){return!fe(t,e)}},ye=function(e){return function(t){return!e.includes(t.key)}},Se=function(e){var t=new URLSearchParams(e);return Array.from(t).filter((function(e){var t=P(e,2),n=t[0],r=t[1];return n&&r})).map((function(e){var t=P(e,2);return{key:t[0],value:t[1]}}))},Ee=function(e){var t=e.value;return""!==t&&void 0!==t},ke=function(e){return Object.entries(e).map((function(e){var t=P(e,2),n=t[0],r=t[1];return pe({key:n,value:r})})).join("&")},Ie=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=e.includes(window.location.pathname)&&!Object.values(de).some((function(t){return e.includes(t)})),i=r?Se(window.location.search):[],s=i.filter(ye(ve)).concat(t).filter(me(n)).reduce(ge,[]).filter(Ee).map(pe).join("&"),o=e.includes("?")?"&":"?";return"".concat(e).concat(s?o:"").concat(s)},be=["ALL","DEPARTMENT","ENDED","USERS"],we=function(){function e(t,n,r){s(this,e),u(this,"stateUnbinders",[]),this.baseNode=t,this.store=n,this.props=r,this.searchFormNode=t.querySelector(b),this.multisearchButtonWrapperNode=t.querySelector(y),this.multisearchButtonNode=t.querySelector(m)}return a(e,[{key:"mount",value:function(){this.addEventListeners(),this.addStateListeners()}},{key:"unmount",value:function(){this.removeEventListeners(),this.removeStateListeners()}},{key:"addEventListeners",value:function(){this.multisearchButtonNode&&this.multisearchButtonNode.addEventListener(_,this),this.searchFormNode.addEventListener(N,this)}},{key:"removeEventListeners",value:function(){this.multisearchButtonNode&&this.multisearchButtonNode.removeEventListener(_,this),this.searchFormNode.removeEventListener(N,this)}},{key:"addStateListeners",value:function(){var e=this;this.stateUnbinders.push(this.store.on(x.InputPhrase,(function(t){return e.handleInputPhraseChange(t)})))}},{key:"removeStateListeners",value:function(){this.stateUnbinders.forEach((function(e){return e()}))}},{key:"handleEvent",value:function(e){e.type===N&&this.onSubmit(e),e.type===_&&this.onMultisearchClick(e)}},{key:"handleInputPhraseChange",value:function(e){var t=e.inputPhrase;this.multisearchButtonWrapperNode&&F(this.multisearchButtonWrapperNode,0===t.length)}},{key:"onMultisearchClick",value:function(e){e.preventDefault(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,n=t.location,r=n.pathname,i=n.search,s=n.hash;e!==s&&(t.history.pushState({previousHash:s},t.document.title,"".concat(r).concat(i).concat(e)),t.dispatchEvent(new HashChangeEvent("hashchange")))}(e.target.hash)}},{key:"onSubmit",value:function(e){var t;e.preventDefault();var n=this.store.inputPhrase.trim(),r=null!==(t=this.props.filters.list[this.store.selectedFilterIndex])&&void 0!==t?t:{};if(n||!j(be,this.store,this.props)||-1!==this.store.activeSuggestionIndex){var i,s=P(B(this.props.advancedSearchCriterias,this.store.checkedAdvancedSearchCriteriaIds),2),o=s[0],a=s[1],u=[].concat(l(o),l(this.props.staticQueryParameters)),c=a;-1!==this.store.activeSuggestionIndex?i=this.store.suggestions.filter(d)[this.store.activeSuggestionIndex].url:r.url?"USERS"===r.type?i="".concat(r.url,"/").concat(n):(i=r.url,u.unshift({key:"string",value:n})):(i=this.props.listingPathname,u.unshift({key:"string",value:n}));var h=Ie(i,u,c);window.document.location.assign(h)}}}]),e}(),Le=function(){function e(t,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:C(),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window;s(this,e),u(this,"stateUnbinders",[]),u(this,"suggesterUnbinders",[]),u(this,"onStateInputPhrase",(function(e){var t=e.inputPhrase;r.clearInputButtonNode&&F(r.clearInputButtonNode,!!t)})),u(this,"onStateNextPhrase",(function(e){var t=e.nextPhrase;r.updateSearchInputValue(t)})),u(this,"onSuggesterClickSuggestionActionIcon",(function(){r.focusNode()})),u(this,"focusNode",(function(){r.searchInputNode.focus()})),u(this,"blurNode",(function(){r.searchInputNode.blur()})),u(this,"onClearInputClick",(function(){r.focusNode(),r.updateSearchInputValue(""),r.emitter.emit("CLEAR")})),u(this,"handleOnKeydown",(function(e){var t={ArrowDown:r.onArrowDownPressAndEmit,ArrowUp:r.onArrowUpPressAndEmit,Escape:r.onEscapePressAndEmit,Delete:r.emitOnDeletePress,Tab:r.emitOnTabPress}[e.key];t&&t(e)})),u(this,"emitOnInput",(function(e){return r.emitter.emit("INPUT",e)})),u(this,"onBlurAndEmit",(function(){r.emitter.emit("BLUR")})),u(this,"emitOnClick",(function(){return r.emitter.emit("CLICK")})),u(this,"onArrowDownPressAndEmit",(function(e){e.preventDefault(),r.emitter.emit("KEY_ARROW_DOWN")})),u(this,"onArrowUpPressAndEmit",(function(e){e.preventDefault(),r.emitter.emit("KEY_ARROW_UP")})),u(this,"emitOnTabPress",(function(){return r.emitter.emit("KEY_TAB")})),u(this,"emitOnDeletePress",(function(){return r.emitter.emit("KEY_DELETE")})),u(this,"onEscapePressAndEmit",(function(){r.updateSearchInputValue(""),r.emitter.emit("KEY_ESCAPE")})),this.baseNode=t,this.store=n,this.emitter=i,this.targetWindow=o,this.searchInputNode=t.querySelector(w),this.clearInputButtonNode=t.querySelector(S)}return a(e,[{key:"mount",value:function(e){this.addEventListeners(),this.addGlobalEventListeners(),this.addStateListeners(),this.addSuggesterListeners(e)}},{key:"unmount",value:function(){this.removeEventListeners(),this.removeGlobalEventListeners(),this.removeStateListeners(),this.removeSuggesterListeners()}},{key:"onUpdate",value:function(e){var t=e.inputPhrase,n=void 0===t?"":t;this.updateSearchInputValue(n)}},{key:"addEventListeners",value:function(){this.searchInputNode.addEventListener("blur",this),this.searchInputNode.addEventListener(_,this),this.searchInputNode.addEventListener("input",this),this.searchInputNode.addEventListener("keydown",this),this.searchInputNode.addEventListener("focus",this),this.clearInputButtonNode&&this.clearInputButtonNode.addEventListener(_,this)}},{key:"addGlobalEventListeners",value:function(){this.targetWindow.addEventListener("touchmove",this,!0)}},{key:"addStateListeners",value:function(){this.stateUnbinders.push(this.store.on(x.InputPhrase,this.onStateInputPhrase),this.store.on(x.NextPhrase,this.onStateNextPhrase))}},{key:"addSuggesterListeners",value:function(e){this.suggesterUnbinders.push(e.on("CLICK_REMOVE_SUGGESTION",this.onSuggesterClickSuggestionActionIcon),e.on("CLICK_REWRITE_SUGGESTION",this.onSuggesterClickSuggestionActionIcon))}},{key:"removeEventListeners",value:function(){this.searchInputNode.removeEventListener("blur",this),this.searchInputNode.removeEventListener(_,this),this.searchInputNode.removeEventListener("input",this),this.searchInputNode.removeEventListener("keydown",this),this.searchInputNode.removeEventListener("focus",this),this.clearInputButtonNode&&this.clearInputButtonNode.removeEventListener(_,this)}},{key:"removeGlobalEventListeners",value:function(){this.targetWindow.removeEventListener("touchmove",this)}},{key:"removeStateListeners",value:function(){this.stateUnbinders.forEach((function(e){return e()}))}},{key:"removeSuggesterListeners",value:function(){this.suggesterUnbinders.forEach((function(e){return e()}))}},{key:"handleEvent",value:function(e){var t=e.type,n=e.currentTarget;if("blur"===t&&this.onBlurAndEmit(),t===_&&(n===this.searchInputNode&&this.emitOnClick(),n===this.clearInputButtonNode&&this.onClearInputClick()),"input"===t){var r=n.value.trim();this.emitOnInput(r),W(this.store,r)}"keydown"===t&&this.handleOnKeydown(e),"touchmove"===t&&this.blurNode()}},{key:"updateSearchInputValue",value:function(e){this.searchInputNode.value=e,W(this.store,e)}}]),e}();function _e(e,t,n,r,i,s,o){try{var a=e[s](o),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,i)}function Ne(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var s=e.apply(t,n);function o(e){_e(s,r,i,o,a,"next",e)}function a(e){_e(s,r,i,o,a,"throw",e)}o(void 0)}))}}var Ce,xe,Ae,Oe,Pe=n("o0o1"),Te=n.n(Pe);function Re(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=Re(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}var je,Ue,Ge,De,ze,Be=function(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=Re(e))&&(r&&(r+=" "),r+=t);return r},Fe="mp7g_f6 mnjl_0 mg9e_0 mvrt_0 mj7a_0 mh36_0 m9tr_5r mq1m_0 mqm6_0 mp4t_56 mryx_56 _535b5_eeYlJ";function Me(e){switch(e.size){case"SMALL":return"mgn2_12 mqu1_16";case"MEDIUM":default:return"mgn2_14 mqu1_21"}}function We(e){return"IMAGE"===e.type?function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return te(Ge||(Ge=$(['<span data-type="IMAGE" class="','">',"</span>"])),Be("_535b5_J8Mvg",n),te(De||(De=$(['<img src="','" alt="">'])),e.url))}(e,Me(e)):function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return te(je||(je=$(['<span data-type="','" class="','">',"</span>"])),e.style,Be("_535b5_J8Mvg",n),te(Ue||(Ue=$(["",""])),e.text))}(e,function(e){switch(e.style){case"STRONG":return"m9qz_yq";case"PRIMARY":return"mgmw_s9";case"SECONDARY":return"mgmw_3z";case"NORMAL":default:return""}}(e),Me(e))}function qe(e){var t=e.buttonClassName,n=e.iconClassName,r=e.icon,i=e.dataRole;return te(ze||(ze=$(['<button tabindex="-1" aria-hidden="true" type="button" class="','" data-role="','"><img class="','" src="','" alt="" /></button>'])),Be("b1vwg",t),i,Be("mjyo_6x meqh_en msa3_z4 m0s5_e6 mg9e_8 mvrt_8 mj7a_8 mh36_8 mhd5_0m mupj_mm mse2_40 m7er_40 _535b5_0xStM",n),r)}var Ke,He,Ye,Ve,Ze=n("Jmsw");var $e=function(){function e(t,n,r){var i=this;s(this,e),u(this,"stateUnbinders",[]),u(this,"onCheckedAdvancedSearchCriteriaIds",(function(e){var t=e.checkedAdvancedSearchCriteriaIds;i.inputElement.checked=t.includes(i.item.id)})),this.baseNode=t,this.item=n,this.store=r,this.inputElement=t.querySelector("input"),this.labelElement=t.querySelector("label")}return a(e,[{key:"mount",value:function(){this.addEventListeners(),this.addStateListeners()}},{key:"unmount",value:function(){this.removeEventListeners(),this.removeStateListeners()}},{key:"addEventListeners",value:function(){this.labelElement.addEventListener(_,this)}},{key:"addStateListeners",value:function(){this.stateUnbinders.push(this.store.on(x.CheckedAdvancedSearchCriteriaIds,this.onCheckedAdvancedSearchCriteriaIds))}},{key:"removeEventListeners",value:function(){this.labelElement.removeEventListener(_,this)}},{key:"removeStateListeners",value:function(){this.stateUnbinders.forEach((function(e){return e()}))}},{key:"handleEvent",value:function(e){e.type===_&&this.onClick(e)}},{key:"onClick",value:function(e){var t=this;e.preventDefault();var n=this.store.checkedAdvancedSearchCriteriaIds,r=this.inputElement.checked?n.filter((function(e){return e!==t.item.id})):[].concat(l(n),[this.item.id]);K(this.store,r)}}]),e}(),Je=function(){return window.opbox.edge};function Qe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Je();return t.get("/search-suggester/suggestions?".concat(ke(e)),{withCredentials:!0,cancelLast:!0,headers:{accept:"application/vnd.allegro.internal.v7+json"}})}function Xe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Je();return t.delete("/search-history/".concat(e),{withCredentials:!0,disableDefaultHeaders:!0})}var et=function(){function e(t,n,r,i){s(this,e),this.anchorNode=t,this.store=n,this.suggestion=r,this.emitter=i,this.rewriteButtonNode=t.querySelector(k),this.removeButtonNode=t.querySelector(E)}return a(e,[{key:"mount",value:function(){this.addEventListeners()}},{key:"unmount",value:function(){this.removeEventListeners()}},{key:"addEventListeners",value:function(){this.anchorNode.addEventListener(_,this),this.removeButtonNode&&this.removeButtonNode.addEventListener(_,this),this.rewriteButtonNode&&this.rewriteButtonNode.addEventListener(_,this)}},{key:"removeEventListeners",value:function(){this.anchorNode.removeEventListener(_,this),this.removeButtonNode&&this.removeButtonNode.removeEventListener(_,this),this.rewriteButtonNode&&this.rewriteButtonNode.removeEventListener(_,this)}},{key:"handleEvent",value:function(e){e.preventDefault(),e.stopPropagation(),e.currentTarget===this.anchorNode&&this.onItemClick(),e.currentTarget===this.removeButtonNode&&this.onRemoveButtonClick(),e.currentTarget===this.rewriteButtonNode&&this.onRewriteButtonClick()}},{key:"onItemClick",value:function(){this.emitter.emit("CLICK_SUGGESTION",this.suggestion)}},{key:"onRemoveButtonClick",value:function(){this.emitter.emit("CLICK_REMOVE_SUGGESTION",this.suggestion)}},{key:"onRewriteButtonClick",value:function(){this.emitter.emit("CLICK_REWRITE_SUGGESTION",this.suggestion)}},{key:"markActive",value:function(){this.anchorNode.setAttribute("aria-selected","true"),q(this.store,this.suggestion.completionText||"")}},{key:"markInactive",value:function(){this.anchorNode.removeAttribute("aria-selected")}}]),e}(),tt=["CATEGORY","DEPARTMENT","ENDED","USER_NAME","CHARITY_ORGANIZATION"],nt=["CATEGORY","DEPARTMENT","CHARITY_ORGANIZATION"],rt=["USER_NAME"],it=["USERS","CHARITY_GOALS","CHARITY_ORGANIZATION","CHARITY_ORGANIZATIONS"];function st(e){switch(e){case"USERS":return"sellers";case"CHARITY_ORGANIZATIONS":return"charity-organizations";case"CHARITY_GOALS":case"CHARITY_ORGANIZATION":return"fundraising-campaigns";default:return"all"}}function ot(e,t){var n=t.filters.list[e.selectedFilterIndex];if(!T(n))return{};var r,i=n.type,s=n.id,o=n.name,a=tt.includes(i),u=nt.includes(i),c=rt.includes(i),h=it.includes(i);switch(i){case"CHARITY_ORGANIZATION":r="charity-organization";break;case"DEPARTMENT":r="category";break;default:r=i.toLowerCase()}return Object.assign({},a?{scope:r}:{},u?{"scope-value":s}:{},c?{"scope-value":o}:{},h?{types:st(i)}:{})}var at=function(){function e(t,n,r,i){var o=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:C(),c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:window;s(this,e),u(this,"isExpanded",!1),u(this,"suggestionItems",[]),u(this,"advancedSearchCriteriaItems",[]),u(this,"stateUnbinders",[]),u(this,"suggesterUnbinders",[]),u(this,"searchInputUnbinders",[]),u(this,"onStateSuggestions",(function(){o.render()})),u(this,"onSearchInputBlur",(function(){o.store.activeSuggestionIndex=-1})),u(this,"onSearchInputClear",(function(){o.fetch()})),u(this,"onSearchInputClick",(function(){o.isExpanded||o.fetch()})),u(this,"onSearchInput",(function(e){o.fetch(e)})),u(this,"onSearchInputTabPress",(function(){o.destroy()})),u(this,"onSearchInputEscapePress",(function(){o.destroy()})),u(this,"onSearchInputArrowUpPress",(function(){o.markPreviousSuggestion()})),u(this,"onSearchInputArrowDownPress",(function(){o.markNextSuggestion()})),u(this,"onSearchInputDeletePress",(function(){if(-1!==o.store.activeSuggestionIndex){var e=o.store.suggestions.filter(d)[o.store.activeSuggestionIndex];o.deleteSuggestion(e)}})),u(this,"fetch",Ne(Te.a.mark((function e(){var t,n,r=arguments;return Te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:o.store.inputPhrase,!j(G,o.store,o.props)&&!U(t,o.props)){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:return n=Object.assign({query:t},o.props.enableSuggesterHistory?{history:!0}:{},ot(o.store,o.props)),e.abrupt("return",Qe(n).then((function(e){var t=e.status,n=e.data,r=n.suggestions,i=n.tracking;o.store.tracking=i,o.store.suggestions=r,o.store.activeSuggestionIndex=-1,o.emitter.emit("RECEIVE_SUGGESTIONS",t)})).catch((function(e){e&&0===e.status||(o.store.tracking={},o.store.suggestions=[],o.store.activeSuggestionIndex=-1,o.emitter.emit("RECEIVE_SUGGESTIONS",e&&e.status||e))})));case 5:case"end":return e.stop()}}),e)})))),u(this,"onToggleExpanded",(function(e){o.isExpanded=e})),u(this,"onClickSuggestion",(function(e){var t=P(B(o.props.advancedSearchCriterias,o.store.checkedAdvancedSearchCriteriaIds),2),n=t[0],r=t[1],i=[].concat(l(n),l(o.props.staticQueryParameters)),s=Ie(e.url,i,r);o.targetWindow.document.location.assign(s)})),u(this,"onClickRewriteSuggestion",(function(e){o.fetch(e.completionText),q(o.store,e.completionText||"")})),u(this,"onClickRemoveSuggestion",(function(e){o.deleteSuggestion(e)})),u(this,"deleteSuggestion",(function(e){var t=e.history,n=t.removable,r=t.id;n&&r&&Xe(r).then((function(e){var t=e.status;t>=200&&t<300&&o.fetch()})).catch(Function.prototype)})),this.baseNode=t,this.store=n,this.props=r,this.searchInput=i,this.emitter=a,this.targetWindow=c,this.suggesterNode=t.querySelector(L),this.mainWrapper=c.document.body.querySelector(".main-wrapper")}return a(e,[{key:"mount",value:function(){this.addStateListeners(),this.addSuggesterListeners(),this.addSearchInputListeners(),this.addGlobalEventListeners()}},{key:"unmount",value:function(){this.removeStateListeners(),this.removeSuggesterListeners(),this.removeSearchInputListeners(),this.removeGlobalEventListeners()}},{key:"onUpdate",value:function(e){var t=e.inputPhrase,n=void 0===t?"":t,r=e.advancedSearchCriterias,i=void 0===r?[]:r;""===n&&this.destroy(),K(this.store,i.filter((function(e){return e.checked})).map((function(e){return e.id})))}},{key:"addStateListeners",value:function(){this.stateUnbinders.push(this.store.on(x.Suggestions,this.onStateSuggestions))}},{key:"addSuggesterListeners",value:function(){this.suggesterUnbinders.push(this.emitter.on("TOGGLE_IS_EXPANDED",this.onToggleExpanded),this.emitter.on("CLICK_SUGGESTION",this.onClickSuggestion),this.emitter.on("CLICK_REWRITE_SUGGESTION",this.onClickRewriteSuggestion),this.emitter.on("CLICK_REMOVE_SUGGESTION",this.onClickRemoveSuggestion))}},{key:"addSearchInputListeners",value:function(){this.searchInputUnbinders.push(this.searchInput.emitter.on("BLUR",this.onSearchInputBlur),this.searchInput.emitter.on("CLEAR",this.onSearchInputClear),this.searchInput.emitter.on("CLICK",this.onSearchInputClick),this.searchInput.emitter.on("INPUT",this.onSearchInput),this.searchInput.emitter.on("KEY_TAB",this.onSearchInputTabPress),this.searchInput.emitter.on("KEY_ESCAPE",this.onSearchInputEscapePress),this.searchInput.emitter.on("KEY_ARROW_UP",this.onSearchInputArrowUpPress),this.searchInput.emitter.on("KEY_ARROW_DOWN",this.onSearchInputArrowDownPress),this.searchInput.emitter.on("KEY_DELETE",this.onSearchInputDeletePress))}},{key:"addGlobalEventListeners",value:function(){this.targetWindow.addEventListener(_,this)}},{key:"removeGlobalEventListeners",value:function(){this.targetWindow.removeEventListener(_,this)}},{key:"removeStateListeners",value:function(){this.stateUnbinders.forEach((function(e){return e()}))}},{key:"removeSuggesterListeners",value:function(){this.suggesterUnbinders.forEach((function(e){return e()}))}},{key:"removeSearchInputListeners",value:function(){this.searchInputUnbinders.forEach((function(e){return e()}))}},{key:"handleEvent",value:function(e){e.type===_&&this.onGlobalClick(e)}},{key:"render",value:function(){var e,t;this.unmountSuggestions(),this.unmountAdvancedSearchCriteria(),this.suggesterNode.innerHTML=(e=this.props,t=this.store,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return e.length?new ee([""].concat(l(Array(e.length-1).fill(t)),[""]),e):""}([].concat(l(t.suggestions.map((function(t){return function(e,t){switch(e.type){case"LABEL":return n=e.view.labelItems,te(Ke||(Ke=$(['<div data-role="','" class="','"><div class="','">',"</div></div>"])),"label","mjyo_lo mp7g_oh mpof_ki mg9e_8 mj7a_8 mvrt_16 mh36_8 mj9z_5r mgmw_wo","meqh_en m7er_k4 mqu1_1 _535b5_cr-H6",n.map(We));case"SUGGESTION":return function(e,t){var n=e.url,r=e.view,i=r.image,s=!!i,o=s&&"AUTO"!==i.size,a=s&&"LARGE"===i.size?"_535b5_70jzr":"_535b5_5HBqT",c=function(e){return e.length?te(He||(He=$(['<div class="','">',"</div>"])),"mqu1_1",e.map(We)):""},h=s?te(Ye||(Ye=$(['<img alt="" src="','" class="','" />'])),i.url,Be("m3h2_8",u({},a,o))):"";return te(Ve||(Ve=$(['<a role="option" href="','" class="','" data-role="','">'," ",'<div class="','">'," ","</div></a>"])),n,Be("mjyo_lo mp7g_oh mpof_ki mg9e_8 mj7a_8 mvrt_16 mh36_8 mj9z_5r mgmw_wo _535b5_iaSxk","mjyo_lo mp7g_oh mpof_ki mvrt_16 mh36_8 mj9z_5r mgmw_wo m389_6m mg9e_4 mj7a_4 _535b5_cqyNy"),"suggestion",h,function(e,t){var n,r=e.history,i=e.completionText;return r.removable?(n=t.enableSuggestionRemovalButtonOnHover,qe({icon:Ze.b,buttonClassName:Be(Fe,n&&"mpof_5r _535b5_EG11e"),dataRole:"remove-recently-searched"})):i&&t.enableRewriteSuggestionButton?qe({icon:Ze.a,iconClassName:"_535b5_5wzhr",buttonClassName:Fe,dataRole:"rewrite-recently-searched"}):""}(e,t),"m7er_k4 _535b5_sl1f0",c(r.labelItems),r.subLabelItems?c(r.subLabelItems):"")}(e,t);default:return""}var n}(t,e)}))),l(function(e,t){return z(t,e)?[]:[t.suggestions.length?te(Ce||(Ce=$(['<hr class="','" />'])),"vmcnm"):"",e.advancedSearchCriterias.map((function(e){return function(e,t){var n=e.id,r=e.label,i=e.badge,s="searchInDescriptionChange"===n;return te(Ae||(Ae=$(['<div data-role="','" class="','"><input type="checkbox" autocomplete="off" id="','" class="','" ',' /><label for="','" class="','">'," ","</label></div>"])),"advanced-search-criteria",s?"mpof_5r mpof_z0_s":"",n,"ch16hq ch1iux cht1i8",t.checkedAdvancedSearchCriteriaIds.includes(n)?te(Oe||(Oe=$(["checked"]))):"",n,"ch1pig munh_16",r,function(e){if(!e)return"";var t=e.textColor,n=e.backgroundColor,r=e.text;return te(xe||(xe=$(['<span class="','" style="color: ',"; background-color: ",';">',"</span>"])),"msbw_2 mldj_2 mtag_2 mm2b_2 mvrt_4 mh36_4 mqu1_16 mgmw_9u msa3_z4 mj9z_5r mp0t_ji mgn2_12 mg9e_2 mj7a_2",t,n,r)}(i))}(e,t)}))]}(e,t))),"")).toString(),this.mountSuggestions(),this.mountAdvancedSearchCriteria(),this.markSuggesterAccordingly()}},{key:"destroy",value:function(){this.unmountSuggestions(),this.unmountAdvancedSearchCriteria(),this.markSuggesterInactive(),this.suggesterNode.innerHTML=""}},{key:"markSuggestionByStepOf",value:function(e){var t=this.suggestionItems.length;if(0!==t){var n,r=this.store.activeSuggestionIndex,i=((Math.max(r,1===e?-1:0)+e)%t+t)%t;this.toggleActiveSuggestions(r,i),n=this.store,M(n,x.ActiveSuggestionIndex,i)}}},{key:"markPreviousSuggestion",value:function(){this.markSuggestionByStepOf(-1)}},{key:"markNextSuggestion",value:function(){this.markSuggestionByStepOf(1)}},{key:"toggleActiveSuggestions",value:function(e,t){-1!==e&&this.suggestionItems[e].markInactive(),this.suggestionItems[t].markActive()}},{key:"mountSuggestions",value:function(){var e=this,t=this.suggesterNode.childNodes;Array.from(t).filter((function(e){return"A"===e.nodeName})).forEach((function(t,n){var r=e.store.suggestions.filter(d)[n],i=new et(t,e.store,r,e.emitter);i.mount(),e.suggestionItems.push(i)}))}},{key:"mountAdvancedSearchCriteria",value:function(){var e=this;this.suggesterNode.querySelectorAll(f).forEach((function(t,n){var r=new $e(t,e.props.advancedSearchCriterias[n],e.store);r.mount(),e.advancedSearchCriteriaItems.push(r)}))}},{key:"unmountSuggestions",value:function(){this.suggestionItems.forEach((function(e){return e.unmount()})),this.suggestionItems=[]}},{key:"unmountAdvancedSearchCriteria",value:function(){this.advancedSearchCriteriaItems.forEach((function(e){return e.unmount()})),this.advancedSearchCriteriaItems=[]}},{key:"markSuggesterAccordingly",value:function(){0===this.store.suggestions.length&&z(this.store,this.props)?this.markSuggesterInactive():this.isExpanded||this.markSuggesterActive()}},{key:"markSuggesterActive",value:function(){this.suggesterNode.setAttribute("aria-expanded","true"),this.emitter.emit("TOGGLE_IS_EXPANDED",!0)}},{key:"markSuggesterInactive",value:function(){this.suggesterNode.setAttribute("aria-expanded","false"),this.emitter.emit("TOGGLE_IS_EXPANDED",!1)}},{key:"onGlobalClick",value:function(e){this.isExpanded&&null===e.target.closest([L,w,S,I].join(","))&&this.destroy()}}]),e}(),ut=function(){function e(t,n,r){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window.localStorage;s(this,e),u(this,"suggesterUnbinders",[]),u(this,"onSubmit",(function(){var e=i.store,t=e.activeSuggestionIndex,n=e.suggestions;if(-1===t)i.saveEntryFromStore();else{var r=n.filter(d)[t];i.saveEntryFromSuggestion(r)}})),u(this,"onSuggesterClickSuggestion",(function(e){i.saveEntryFromSuggestion(e)})),u(this,"getFilterScopeData",(function(){var e=i.props.filters.list[i.store.selectedFilterIndex];return{scope:"DEPARTMENT"===e.type?"CATEGORY":e.type,scopeValue:"USER_NAME"===e.type?e.name:e.id}})),u(this,"saveEntryFromSuggestion",(function(e){var t=e.action;if(e.history.save&&t){var n=Object.assign({action:t,userQuery:null,id:e.history.id},i.getFilterScopeData());i.saveEntry(n)}})),this.baseNode=t,this.store=n,this.props=r,this.localStorage=o,this.searchFormNode=t.querySelector(b)}return a(e,[{key:"mount",value:function(e){this.postHistoryEntry(),this.addEventListeners(),this.addSuggesterListeners(e)}},{key:"unmount",value:function(){this.removeEventListeners(),this.removeSuggesterListeners()}},{key:"addSuggesterListeners",value:function(e){this.suggesterUnbinders.push(e.on("CLICK_SUGGESTION",this.onSuggesterClickSuggestion))}},{key:"addEventListeners",value:function(){this.searchFormNode.addEventListener(N,this)}},{key:"removeSuggesterListeners",value:function(){this.suggesterUnbinders.forEach((function(e){return e()}))}},{key:"removeEventListeners",value:function(){this.searchFormNode.removeEventListener(N,this)}},{key:"handleEvent",value:function(e){e.type===N&&this.onSubmit()}},{key:"saveEntryFromStore",value:function(){var e=Object.assign({userQuery:this.store.inputPhrase},this.getFilterScopeData());this.saveEntry(e)}},{key:"saveEntry",value:function(e){e.scope&&(e.action||e.userQuery)&&this.localStorage.setItem("opbox-search-history",JSON.stringify(e))}},{key:"getEntry",value:function(){return JSON.parse(this.localStorage.getItem("opbox-search-history")||"null")}},{key:"removeEntry",value:function(){this.localStorage.removeItem("opbox-search-history")}},{key:"postHistoryEntry",value:function(){var e=this,t=this.getEntry();t&&function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Je();return t.post("/search-history",e,{withCredentials:!0,headers:{"content-type":"application/vnd.allegro.internal.v2+json"}})}(t).then((function(){return e.removeEntry()}))}}]),e}(),ct=function(){function e(t){var n=this,r=t.baseNode,i=t.props;s(this,e),u(this,"onUpdate",(function(e){n.searchInput.onUpdate(e),n.suggester.onUpdate(e)})),this.baseNode=r,this.props=i,this.store=new O(i),this.searchInput=new Le(r,this.store),this.searchForm=new we(r,this.store,i),this.suggester=new at(r,this.store,i,this.searchInput),this.filters=new le(r,this.store,i),i.enableSuggesterHistory&&(this.history=new ut(r,this.store,i)),this.analyticsDispatcher=new Z(r,this.store,i)}return a(e,[{key:"onMount",value:function(){this.analyticsDispatcher.mount(this.suggester.emitter),this.props.enableSuggesterHistory&&this.history.mount(this.suggester.emitter),this.searchInput.mount(this.suggester.emitter),this.searchForm.mount(),this.filters.mount(),this.suggester.mount()}},{key:"onUnmount",value:function(){this.analyticsDispatcher.unmount(),this.props.enableSuggesterHistory&&this.history.unmount(),this.searchInput.unmount(),this.searchForm.unmount(),this.filters.unmount(),this.suggester.unmount()}}]),e}();window.opbox.component.register({prototypeName:"allegro.metrumHeader.search",clientImplementationVersion:i.a},ct)},cDf5:function(e,t){function n(t){return e.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},fsL8:function(e,t,n){var r=n("cDf5").default;function i(){"use strict";e.exports=i=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},n=Object.prototype,s=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function h(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(e){h=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var i=t&&t.prototype instanceof f?t:f,s=Object.create(i.prototype),o=new _(r||[]);return s._invoke=function(e,t,n){var r="suspendedStart";return function(i,s){if("executing"===r)throw Error("Generator is already running");if("completed"===r){if("throw"===i)throw s;return{value:void 0,done:!0}}for(n.method=i,n.arg=s;;){var o=n.delegate;if(o){var a=b(o,n);if(a){if(a===v)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=d(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(e,n,o),s}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var v={};function f(){}function g(){}function p(){}var m={};h(m,a,(function(){return this}));var y=Object.getPrototypeOf,S=y&&y(y(N([])));S&&S!==n&&s.call(S,a)&&(m=S);var E=p.prototype=f.prototype=Object.create(m);function k(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,t){var n;this._invoke=function(i,o){function a(){return new t((function(n,a){!function n(i,o,a,u){var c=d(e[i],e,o);if("throw"!==c.type){var h=c.arg,l=h.value;return l&&"object"==r(l)&&s.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,u)}),(function(e){n("throw",e,a,u)})):t.resolve(l).then((function(e){h.value=e,a(h)}),(function(e){return n("throw",e,a,u)}))}u(c.arg)}(i,o,n,a)}))}return n=n?n.then(a,a):a()}}function b(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return v;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var r=d(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,v;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,v):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function N(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(s.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:C}}function C(){return{value:void 0,done:!0}}return g.prototype=p,h(E,"constructor",p),h(p,"constructor",g),g.displayName=h(p,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,h(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},k(I.prototype),h(I.prototype,u,(function(){return this})),t.AsyncIterator=I,t.async=function(e,n,r,i,s){void 0===s&&(s=Promise);var o=new I(l(e,n,r,i),s);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},k(E),h(E,c,"Generator"),h(E,a,(function(){return this})),h(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=N,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&s.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var a=s.call(i,"catchLoc"),u=s.call(i,"finallyLoc");if(a&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&s.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;L(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:N(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),v}},t}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},o0o1:function(e,t,n){var r=n("fsL8")();e.exports=r;try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},rRL6:function(e,t){e.exports="e5e"}}));
//# sourceMappingURL=index-pl-PL_9fd9d540.js.map