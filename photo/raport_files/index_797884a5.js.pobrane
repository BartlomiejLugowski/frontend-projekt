!function(e,t){for(var n in t)e[n]=t[n]}(window,function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="https://assets.allegrostatic.com/sc-17194/",n(n.s=0)}({0:function(e,t,n){e.exports=n("WdQY")},"1OyB":function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return r}))},WdQY:function(e,t,n){"use strict";n.r(t);var r,i,o=n("rRL6"),a=n.n(o),u=n("1OyB"),c=n("vuIU");function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.DESKTOP="desktop",e.ANDROID="phone-android",e.IPHONE="phone-iphone",e.PHONE="phone",e.ANDROID_APP="mobileapp-android",e.IPHONE_APP="mobileapp-iphone",e.APP="mobileapp",e.TABLET="tablet"}(r||(r={})),function(e){e.WEB="web",e.MWEB="mweb",e.OTHER="other"}(i||(i={}));var d=function(e){if(e)return e.map((function(e){return{id:e.id,name:e.name,alias:e.alias}}))},p=["1"],l=Error("Failed to render survey"),f=function(){function e(t){var n=this,o=t.window,a=t.api,c=t.props;Object(u.a)(this,e),s(this,"getSurveyInitiationData",(function(e){var t=function(e){switch(e){case r.DESKTOP:case r.TABLET:return i.WEB;case r.PHONE:case r.IPHONE:case r.ANDROID:return i.MWEB;default:return i.OTHER}}(n.props.device);return t===i.OTHER?null:{channelName:t,userLocation:{url:n.window.location.toString(),categoryPath:d(n.props.categoryPath)},event:e}})),s(this,"requestSurvey",(function(e){n.surveyRequested=!0;var t=n.getSurveyInitiationData(e);t&&n.api.fetchSurveyInitiationData(t).then((function(e){e&&200===e.status&&e.data&&n.showSurvey(e.data.surveyId,e.data.showDelay)}))})),s(this,"markPresented",(function(e){if(!p.includes(e)){var t=n.getSurveyInitiationData();t&&n.api.markPresented(e,t)}})),s(this,"initSurvey",(function(){n.window.document.hidden?n.window.document.addEventListener("visibilitychange",(function e(){"visible"!==document.visibilityState||n.surveyRequested||(n.requestSurvey(),n.window.document.removeEventListener("visibilitychange",e))})):n.requestSurvey()})),s(this,"showSurvey",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0";n.window.opbox.page.render.fragment({pathname:"".concat("/ankiety/modal","/").concat(e),additionalQueryParameters:{delay:t}}).catch((function(){n.window.opbox.reportError(l)}))})),s(this,"sendEvent",(function(e,t){var r=t?{value:t}:void 0;n.requestSurvey({name:e,payload:r})})),this.window=o,this.props=c,this.api=a,this.surveyRequested=!1,this.initSurvey()}return Object(c.a)(e,[{key:"getPublicApi",value:function(){return{showSurvey:this.showSurvey,sendEvent:this.sendEvent,markPresented:this.markPresented}}}]),e}(),v={headers:{Accept:"application/vnd.allegro.internal.v1+json","Content-Type":"application/vnd.allegro.internal.v1+json"},withCredentials:!0},y=Object(c.a)((function e(t){var n=this,r=t.window;Object(u.a)(this,e),s(this,"retries",0),s(this,"fetchSurveyInitiationData",(function(e){return n.window.opbox.edge.post("/survey/search/byLocation",e,v).catch((function(e){n.window.opbox.reportError(e)}))})),s(this,"markPresented",(function(e,t){return n.window.opbox.edge.post("/survey/".concat(e,"/presented/byLocation"),t,v).then((function(e){return n.retries=0,e})).catch((function(r){if(n.window.opbox.reportError(r),n.retries+=1,!(n.retries>3))return new Promise((function(e){setTimeout(e,300*n.retries)})).then((function(){return n.markPresented(e,t)}))}))})),this.window=r})),w=function(e){var t=e.pluginName,n=e.clientImplementationVersion;try{return JSON.parse(window.document.querySelector('script[data-serialize-plugin-name="'.concat(t,'"][data-civ="').concat(n,'"]')).textContent)}catch(e){return window.opbox.reportError(Error('Missing serialized props of plugin "'.concat(t,'", with civ "').concat(n,'"'))),{}}}({pluginName:"survey",clientImplementationVersion:a.a}).surveyConfiguration;if(w&&w.enabled){var h=new y(window);window.opbox.plugin.register({name:"survey"},new f({window:window,api:h,props:w}).getPublicApi())}},rRL6:function(e,t){e.exports="73d"},vuIU:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}n.d(t,"a",(function(){return i}))}}));
//# sourceMappingURL=index_797884a5.js.map