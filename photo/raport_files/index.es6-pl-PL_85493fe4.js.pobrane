((e,t)=>{for(var s in t)e[s]=t[s]})(window,(e=>{var t={};function s(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,s),r.l=!0,r.exports}return s.m=e,s.c=t,s.d=(e,t,o)=>{s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=(e,t)=>{if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(o,r,(t=>e[t]).bind(null,r));return o},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,"a",t),t},s.o=(e,t)=>({}.hasOwnProperty.call(e,t)),s.p="https://assets.allegrostatic.com/sc-10556/",s(s.s=0)})({"/wBL"(e){e.exports=JSON.parse('{"a":"https://assets.allegrostatic.com/metrum/icon/arrowhead-9148b8f39c.svg","b":"https://assets.allegrostatic.com/metrum/icon/parcel-with-pin-f80869904e.svg","c":"https://assets.allegrostatic.com/metrum/icon/three-dots-cc8d7d016a.svg"}')},0(e,t,s){e.exports=s("O14P")},O14P(e,t,s){s.r(t);var o={};s.r(o),s.d(o,"inbox",()=>i),s.d(o,"inboxLoginButton",()=>m),s.d(o,"messages",()=>l),s.d(o,"message",()=>c),s.d(o,"messageLink",()=>_),s.d(o,"text",()=>d),s.d(o,"messageText",()=>p),s.d(o,"emptyText",()=>g),s.d(o,"guestText",()=>u),s.d(o,"errorText",()=>h),s.d(o,"guestContentWrapper",()=>f),s.d(o,"registerButton",()=>v),s.d(o,"spinnerWrapper",()=>y),s.d(o,"spinner",()=>w),s.d(o,"messageDisplayed",()=>$),s.d(o,"messageNew",()=>b),s.d(o,"messageClicked",()=>k),s.d(o,"messageIcon",()=>x),s.d(o,"messageTime",()=>j),s.d(o,"right9px",()=>q),s.d(o,"messageMenuDropdown",()=>L),s.d(o,"messageMenuDropdownToggle",()=>z),s.d(o,"messageMenuDropdownToggleActive",()=>E),s.d(o,"messageMenuDropdownContentContainer",()=>D),s.d(o,"messageMenuDropdownContent",()=>M),s.d(o,"messageMenuDropdownOpen",()=>S),s.d(o,"messageMenuActions",()=>T),s.d(o,"messageMenuAction",()=>C),s.d(o,"messageMenuActionLink",()=>P),s.d(o,"messageGroup",()=>I),s.d(o,"messageGroupHeader",()=>A),s.d(o,"messageGroupToggle",()=>N),s.d(o,"arrowIcon",()=>O),s.d(o,"messageGroupToggleOpen",()=>B),s.d(o,"messageGroupContentInvisible",()=>G),s.d(o,"messageGroupContent",()=>U),s.d(o,"messageGroupContentVisible",()=>W);var r={};s.r(r),s.d(r,"container",()=>me),s.d(r,"header",()=>le),s.d(r,"redirectBtn",()=>ce),s.d(r,"notificationsHeader",()=>_e),s.d(r,"notificationsHeaderActions",()=>de),s.d(r,"notificationsLastUpdate",()=>pe),s.d(r,"notificationsCounter",()=>ge),s.d(r,"notificationsBtn",()=>ue),s.d(r,"notificationsBtnActive",()=>he),s.d(r,"notificationsWrapper",()=>fe),s.d(r,"offer",()=>ve),s.d(r,"offerImg",()=>ye),s.d(r,"mProgress",()=>we),s.d(r,"parcelDeadlineText",()=>$e);var a={};function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}s.r(a),s.d(a,"container",()=>be),s.d(a,"containerTypeLabel",()=>ke);var i="mpof_z0 m7er_k4 _51ce4_3ysel",m="mgn2_14 mp0t_0a m9qz_yp mp7g_oh mse2_40 mqu1_40 mtsp_ib mli8_k4 m3h2_0 munh_0 m911_5r mefy_5r mnyp_5r mdwl_5r msbw_2 mldj_2 mtag_2 mm2b_2 mqvr_2 msa3_z4 mqen_m6 meqh_en m0qj_5r mh36_16 mvrt_16 mg9e_0 mj7a_0 mjir_sv m2ha_2 m8qd_qh mjt1_n2 b1xj6 mgmw_9u msts_enp mrmn_qo mrhf_u8 m31c_kb m0ux_fp b1nec mp4t_16 mryx_32 mpof_vs mupj_5k _51ce4_ERK1D",l="mx4z_5x mr3m_1 m7er_k4 mp4t_0 m3h2_0 mryx_0 munh_0 mg9e_0 mvrt_0 mj7a_0 mh36_0 mdwt_56 _51ce4_3KcyV",c="mp7g_oh mpof_z0 mp4t_0 m3h2_0 mryx_0 munh_0 mg9e_0 mvrt_0 mj7a_0 mh36_0 msts_9u _51ce4_27WWV",_="mpof_ki mli2_1 mj9z_5r m7f5_5x m389_5x _51ce4_3NjUU",d="mgn2_14 mp0t_0a mqu1_21 mgmw_wo mli8_k4 mp4t_0 m3h2_0 mryx_0 munh_0 _51ce4_10wpA",p="mgn2_14 mp0t_0a mqu1_21 mgmw_wo mli8_k4 mp4t_0 m3h2_0 mryx_0 munh_0 _51ce4_yC03d",g="mzmg_6m mgmw_ag mg9e_24 mj7a_24",u="mgmw_ag",h="m7er_56 msts_szl mx4z_5x mg9e_16 mvrt_16 mj7a_16 mh36_16 mp4t_16",f="mzmg_6m mg9e_24 mj7a_24",v="mgn2_14 mp0t_0a m9qz_yp mp7g_oh mse2_40 mqu1_40 mtsp_ib mli8_k4 mp4t_0 m3h2_0 mryx_0 munh_0 m911_5r mefy_5r mnyp_5r mdwl_5r msbw_2 mldj_2 mtag_2 mm2b_2 mqvr_2 msa3_z4 mqen_m6 meqh_en m0qj_5r msts_n7 mh36_16 mvrt_16 mg9e_0 mj7a_0 mjir_sv m2ha_2 m8qd_qh mjt1_n2 b1xj6 mgmw_u5g mrmn_qo mrhf_u8 m31c_kb m0ux_fp b10hn mpof_vs",y="mpof_ki m7f5_6m m389_6m mse2_k4",w="mpof_z0 meqh_en mse2_40 mg9e_4 mvrt_4 mj7a_4 mh36_4 mjyo_6x m7er_40 kbcjb mp4t_24 m3h2_24 mryx_24 munh_24",$="_51ce4_2yU-d",b="_51ce4_3BP2u",k="_51ce4_1a6Wt",x="mjyo_6x mse2_40 meqh_en msa3_z4 m0s5_e6 mhd5_0m ivrkk mg9e_0 mvrt_0 mj7a_0 mh36_0 mli2_0 _51ce4_20QA1",j="mp4t_4 mgmw_3z mp0t_0a mgn2_12 mqu1_16 mli8_k4 mpof_ki m389_6m _51ce4_ETIEc",q="_51ce4_E6ipK",L="mp7g_f6 mqen_m6 m9tr_5r _51ce4_E6ipK _51ce4_248ly",z="mgn2_14 mp0t_0a mgmw_wo mqu1_21 mj9z_5r mli8_k4 mqen_m6 l1fas mg9e_0 mvrt_0 mj7a_0 mh36_0 m911_5r mefy_5r mnyp_5r mdwl_5r msa3_z4 m0qj_5r msts_n7 l1v1s m9vn_d2 m9vn_gl_m _51ce4_2e_I7",E="m9vn_d2",D="mp7g_oh",M="mp7g_f6 mpof_5r mjyo_6x mjb5_w6 mg9e_0 mvrt_0 mj7a_0 mh36_0 msts_9u mx7m_1 m911_co mefy_co mnyp_co mdwl_co mlkp_ag mnjl_0 _51ce4_wYIFj",S="_51ce4_3JGSa",T="mp0t_0a mgn2_14 mqu1_21 mgmw_wo mli8_k4 mb54_5r m7er_k4 mzmg_6m mh36_16 mvrt_16 _51ce4_2_Zk-",C="mryx_0",P="mgn2_14 mp0t_0a mgmw_wo mqu1_21 mj9z_5r mli8_k4 mqen_m6 l1fas mg9e_0 mvrt_0 mj7a_0 mh36_0 m911_5r mefy_5r mnyp_5r mdwl_5r msa3_z4 m0qj_5r msts_n7 l1v1s mtsp_ib",I="_51ce4_3CcuH",A="mp7g_oh _51ce4_2SLxp",N="mp7g_f6 mqen_m6 _51ce4_E6ipK _51ce4_2xCmc",O="mjyo_6x meqh_en msa3_z4 m0s5_e6 mhd5_0m ivrkk mg9e_0 mvrt_0 mj7a_0 mh36_0 mse2_24 _51ce4_3d2yY",B="_51ce4_337Tu",G="mpof_5r",U="mpof_5r _51ce4_1qkU4 _51ce4_2csNU",W="mpof_z0";const R={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#x27;"},K=/<|>|&|"|'/g,V=/"|'/g,H=RegExp(Array.from("javascript:",e=>e+"[\\n\\r\\t]*").join(""),"ig"),Z=e=>R[e],F=e=>e.replace(V,Z).replace(H,"");class Y{constructor(e,t){this.$=e[0];for(let s=0;s<t.length;s++){const o=t[s];if(Array.isArray(o))for(let e=0;e<o.length;e++)this.$esc(o[e]);else this.$esc(o);this.$+=e[s+1]}}$esc(e){this.$+=e instanceof Y?e.$:(e+"").replace(K,Z)}toString(){return this.$}}const J=e=>new Y([e+""],[]),X=e=>new Y([F(e+"")],[]);var Q=(e,...t)=>new Y(e,t),ee=s("/wBL");const te={"pl-PL":{delete:[["",["Usuń wiadomość"]]],"delete-thread":[["",["Usuń cały wątek"]]],"more-than-month":[["",["ponad miesiąc"]]],ago:[["",["temu"]]],day:[["",["dzień","dni"]]],"hour-short":[["",["godz."]]],"minute-short":[["",["min."]]],sent:[["",["Wysłane"]]],category:[["",["Kategoria"]]],"expand-thread":[["",["Rozwiń wątek"]]],"expand-menu":[["",["Rozwiń menu"]]],"manage-message":[["",["Zarządzaj tą wiadomością"]]],"loading-messages-failed":[["",["Nie mogliśmy wyświetlić Twoich powiadomień."]]],login:[["",["Zaloguj się"]]],register:[["",["Zarejestruj się"]]],"log-in-to-show-messages":[["",["Zaloguj się, aby zobaczyć <br>swoje powiadomienia."]]],"dont-have-account":[["",["Nie masz jeszcze konta?"]]],"no-new-messages":[["",["Nie masz żadnych <br>nowych powiadomień."]]],"parcel-for-pickup":[["",["Przesyłka do odbioru"]]],"purchase-details":[["",["Szczegóły zakupu"]]],"parcels-for-pickup":[["",["Masz przesyłkę do odbioru","Masz {{count}} przesyłki do odbioru","Masz {{count}} przesyłek do odbioru"]]],"show-parcels-for-pickup":[["",["Pokaż przesyłki"]]],"pickup-to":[["",["Odbierz do"]]],"show-messages":[["",["Pokaż wiadomości"]]],"parcel-icon":[["",["Ikona paczki"]]],"offer-image":[["",["Zdjęcie oferty"]]]}},se=/({{[^}]+}}|{%[^%}]+%})/g,oe=/({{[^}]+}})/g,re=/({%[^%}]+%})/g,ae=/({{\s*|\s*}}|{%\s*|\s*%})/g;function ne(e,t=""){if("string"==typeof e)throw Error("Translation has to be an array");return e.find(e=>e[0]===t)[1]}const ie=(e,t,s)=>{const o=te["pl-PL"][e];if(!o)throw Error(`Missing translation for lang "pl-PL" and key "${e}"`);return t?((e,t,s)=>{let o=ne(e,t.context);return parseInt(t.count,10)>=0?o=((e,t)=>{const s=1==(o=t)?0:o%10>=2&&o%10<=4&&(o%100<10||o%100>=20)?1:2;var o;return"boolean"!=typeof s?e[s]:e[s?1:0]})(o,t.count):[o]=o,((e,t,s)=>{if(s){let s=0;return e.split(se).map(o=>{if(o.match(re)){const r=t.formatters[s];if(r)return s+=1,r(o.replace(ae,""));throw Error(`Missing translation formatter for "${e}"`)}return o.match(oe)?t[o.replace(ae,"")]:o})}const o=e.match(se);let r=0;return o?o.reduce((s,o)=>{const a=o.replace(ae,"");if(o.match(re)){const n=t.formatters[r];if(n)return r+=1,s.replace(o,n(a));throw Error(`Missing translation formatter for "${e}"`)}return o.match(oe)?s.replace(o,t[a]):s},e):e})(o,t,s)})(o,t,s):ne(o)[0]};var me="mgn2_14 mp0t_0a mqu1_21 mgmw_wo mli8_k4 mg9e_8 mvrt_8 mj7a_8 mh36_8 munh_56 m3h2_56 _51ce4_1pt0H",le="m7er_k4 mpof_ki m389_6m m9qz_yr _51ce4_2kAGY",ce="mgn2_14 mp0t_0a m9qz_yp mp7g_oh mse2_40 mqu1_40 mtsp_ib mli8_k4 m3h2_0 mryx_0 munh_0 m911_5r mefy_5r mnyp_5r mdwl_5r msbw_2 mldj_2 mtag_2 mm2b_2 mqvr_2 msa3_z4 mqen_m6 meqh_en m0qj_5r mh36_16 mvrt_16 mg9e_0 mj7a_0 mjir_sv m2ha_2 m8qd_qh mjt1_n2 b1xj6 mgmw_9u msts_enp mrmn_qo mrhf_u8 m31c_kb m0ux_fp b1nec m7er_k4 mp4t_16",_e="mgn2_13 mpof_ki m389_6m m7f5_sf mgmw_gb mp4t_16 mryx_8 _51ce4_1UR8x",de="mpof_ki m389_6m m7f5_sf _51ce4_3iIDF",pe="mgn2_12 munh_8",ge="mpof_ki m7f5_6m m389_6m msts_ho mgmw_9u _51ce4_3PprM",ue="m911_5r mefy_5r mnyp_5r mdwl_5r mg9e_0 mvrt_0 mj7a_0 mh36_0 mqen_m6 msts_n7",he="_51ce4_B-AXv",fe="mpof_5r",ve="mp4t_24 mpof_ki m389_6m mryx_16",ye="m7er_40 mse2_40 m3h2_16 mpof_ki m7f5_6m m389_6m _51ce4_1KVzj",we="m0qj_5r mjyo_6x mpof_z0 m7er_k4 m911_5r mefy_5r mnyp_5r mdwl_5r ps1abq",$e="mryx_8 _51ce4_3nCq7",be="msbw_4 mldj_4 mm2b_4 mtag_4 mp7g_oh mg9e_16 mvrt_16 mj7a_16 mh36_16 mx7m_1 m911_co mefy_co mnyp_co mdwl_5r mp4t_16 _51ce4_1nnvJ",ke="_51ce4_2NfZE";const xe=(je=Object.assign({},r,{},a,{},o),(...e)=>e.map(e=>je[e]||e).join(" "));var je;let qe,Le,ze,Ee,De,Me,Se,Te,Ce,Pe,Ie,Ae,Ne,Oe=e=>e;const Be=(Ge=new Date,e=>`${(e=>{if(e>=2592e3)return ie("more-than-month");if(e>=86400){const t=Math.floor(e/86400);return`${t} ${ie("day",{count:t>1?2:1})}`}return e>=3600?`${Math.floor(e/3600)} ${ie("hour-short")}`:`${Math.max(1,Math.floor(e/60))} ${ie("minute-short")}`})(Math.floor((Ge-e)/1e3))} ${ie("ago")}`);var Ge;const Ue=Q(qe||(qe=Oe`<img class="${0}" src="${0}" alt="${0}" width="100%" height="100%" />`),O,ee.a,ie("expand-thread")),We=Q(Le||(Le=Oe`<img class="${0}" src="${0}" alt="${0}" width="100%" height="100%" />`),O,ee.c,ie("expand-menu"));function Re({text:e,image:{svg:t},status:s,createdAt:o,tinkerbellId:r,groupId:a},n=!1){const i=xe("message","message"+(s.charAt(0)+s.slice(1).toLowerCase()));return Q(Te||(Te=Oe`<li class="${0}" data-role="message">${0} ${0}</li>`),i,((e,t=!1,s=null)=>Q(Me||(Me=Oe`<div class="${0}" data-role="message-actions-dropdown"><button type="button" data-role="message-dropdown" aria-label="${0}" class="${0}">${0}</button><div class="${0}"><div class="${0}">${0}</div></div></div>`),L,ie("manage-message"),z,We,D,M,((e,t,s)=>{const[o,r,a]=e?["action-delete-group",ie("delete-thread"),t]:["action-delete",ie("delete"),s];return Q(De||(De=Oe`<ul class="${0}"><li class="${0}"><button type="button" class="${0}" data-role="${0}" data-id-to-delete="${0}">${0}</button></li></ul>`),T,C,P,o,a,r)})(t,s,e)))(r,n,a),((e,t,s,o)=>Q(Se||(Se=Oe`<a data-role="message-link" href="${0}" class="${0}" data-analytics-clickable data-analytics-click-value="${0}">${0}<span><span class="${0}">${0}</span>${0}</span></a>`),"/inbox/redirect/id/"+t,_,s,(e=>Q(Ee||(Ee=Oe`<img class="${0}" src="${0}" alt="${0}" width="100%" height="100%" />`),x,e,ie("category")))(o),p,s,J((e=>{const t=new Date(e),s=t.toLocaleDateString(),o=Be(t);return Q(ze||(ze=Oe`<time class="${0}" datetime="${0}" aria-label="${0} ${0}">${0}</time>`),j,s,ie("sent"),o,o)})(e))))(o,r,e,t))}const Ke=e=>Re(e,!1);function Ve(e){if(1===e.length)return Ke(e[0]);const[t,...s]=e,o=Re(t,!0),r=s.map(Ke).join(""),a=Q(Ce||(Ce=Oe`<div class="${0}" data-role="message-group-toggle">${0}</div>`),N,Ue);return Q(Pe||(Pe=Oe`<li class="${0}"><ol class="${0}">${0} ${0}</ol><ol data-role="message-group-content" class="${0}">${0}</ol></li>`),I,A,J(o),J(a),U,J(r))}function He(e){return"group_"+e}function Ze({className:e,content:t}){return Q(Ae||(Ae=Oe`<p class="${0} ${0}">${0}</p>`),e,d,J(t))}function Fe(){const e=ie("no-new-messages");return Ze({className:g,content:e})}function Ye({loginUrl:e,registerUrl:t}){const s=ie("log-in-to-show-messages"),o=ie("dont-have-account"),r=Ze({className:u,content:s}),a=Ze({className:u,content:o});return Q(Ne||(Ne=Oe`<div class="${0}">${0}<a href="${0}" class="${0}" rel="nofollow" data-role="login-button">${0}</a>${0}<a href="${0}" class="${0}" rel="nofollow" data-analytics-clickable data-role="register-button">${0}</a></div>`),f,J(r),X(e),m,ie("login"),J(a),X(t),v,ie("register"))}function Je({messages:e}){return e.length>0?(e=>{const t=(e=>{const t=e.reduce((e,t)=>{const s=e,o=t.groupId||t.tinkerbellId;return(s[He(o)]||(s[He(o)]=[])).push(t),s},{});return Object.values(t)})(e).map(Ve).join("");return Q(Ie||(Ie=Oe`<ul class="${0}" data-role="message-list">${0}</ul>`),l,J(t))})(e):Fe()}let Xe,Qe,et,tt,st,ot,rt,at,nt,it,mt,lt=e=>e,ct=e=>e;const _t=new Intl.DateTimeFormat("pl-PL",{year:"numeric",month:"numeric",day:"numeric"});function dt(e){return Q(tt||(tt=ct`<div class="${0}"><img src="${0}" alt="${0}"><span>${0}</span></div>`),le,ee.b,ie("parcel-icon"),e)}function pt(e,t){return Q(rt||(rt=ct`<a href="${0}" data-role="redirect-button"><button class="${0}">${0}</button></a>`),t,ce,e)}function gt(e){return 0===e.length?"":Q(at||(at=ct`<div><div class="${0}"><div class="${0}">${0}</div><div class="${0}"><span class="${0}">${0}</span><button type="button" data-role="show-parcels-notifications" class="${0}"><img src="${0}" alt="${0}"></button></div></div><div data-role="parcels-notifications" class="${0}">${0}</div></div>`),_e,pe,(e=>{const t=new Date(e);return`${_t.format(t)} ${t.toLocaleTimeString("pl-PL",{hour:"numeric",minute:"numeric"})}`})(e[0].createdAt),de,ge,e.length,ue,ee.a,ie("show-messages"),fe,Je({messages:e}))}class ut{constructor(e,t){this.loginButton=e.querySelector('[data-role="login-button"]'),this.registerButton=e.querySelector('[data-role="register-button"]'),this.path=t}mount(){this.loginButton&&this.loginButton.addEventListener("click",this),this.registerButton&&this.registerButton.addEventListener("click",this)}handleEvent(e){"click"===e.type&&((e,t)=>{e.preventDefault();const{target:s}=e;window.location.href=((e,t)=>`${e}?origin_url=${encodeURIComponent(""+(t||"/"))}`)(s.getAttribute("href"),t)})(e,this.path)}}const ht="."+I;class ft{constructor(e,t,s,o,r){var a=this;n(this,"loadData",async()=>{let e="",t=null,s=[];const o=await a.api.getMessages();try{t=await a.api.getPackegesStatuses(),s=t.data.waybillIds}catch(r){}if(t){const{notifications:s,parcelNotifications:r}=(({messages:e},t)=>{const s=[],o=[];return e.forEach(e=>{((e,t)=>{let s=!1;return t.forEach(t=>{e.groupId===t&&(s=!0)}),s})(e,t)?s.push(e):o.push(e)}),{parcelNotifications:s,notifications:o}})(o.data,t.data.groupIds);e=`${(({data:e},t)=>{let s;const{parcelToPickup:o,parcelsToPickupCounter:r,ordersUrl:a,alert:n}=e;return 0===r?"":(s=1===r?((e,t,s)=>{return Q(nt||(nt=ct` ${0} ${0} ${0} ${0} ${0} ${0} `),dt(ie("parcel-for-pickup")),s?(({body:e})=>Q(et||(et=lt`<div class="${0} ${0}">${0}</div>`),be,ke,(e=>{const t=e.map(e=>{const{type:t,value:s,style:o}=e;return"NEW_LINE"===t?Q(Xe||(Xe=lt`<br/>`)):"TEXT"===t?"BOLD"===o?(e=>Q(Qe||(Qe=lt`<strong>${0}</strong>`),e))(s):s:""}).join("");return J(t)})(e)))(s):"",(o=e.offer,Q(st||(st=ct`<div class="${0}"><div class="${0}"><img src="${0}" alt="${0}"></div><div>${0}</div></div>`),ve,ye,o.imageUrl,ie("offer-image"),o.text)),e.validTo?(({validFrom:e,validTo:t})=>{const s=t-e,o=(new Date).getTime()-e,r=Math.round(o/s*100),a=new Date(t),n=a.getDate(),i=a.getFullYear(),m=a.toLocaleDateString("pl-PL",{weekday:"short"}),l=a.toLocaleDateString("pl-PL",{month:"short"}),c=a.toLocaleTimeString("pl-PL",{hour:"numeric",minute:"numeric"});return Q(ot||(ot=ct`<div><div class="${0}"><span>${0}:</span>${0}</div><progress class="${0}" value="${0}" max="100" aria-valuemax="100" aria-valuemin="0" aria-valuenow="20" role="progressbar"></progress></div>`),$e,ie("pickup-to"),` ${m} ${n} ${l} ${i}, ${c}`,we,r)})(e):"",pt(ie("purchase-details"),e.orderUrl),gt(t));var o})(o,t,n):((e,t,s)=>Q(it||(it=ct` ${0} ${0} ${0} `),dt(ie("parcels-for-pickup",{count:e})),pt(`${ie("show-parcels-for-pickup")}(${e})`,s),gt(t)))(r,t,a),Q(mt||(mt=ct`<div class="${0}">${0}</div>`),me,s))})(t,r)}${Je({messages:s})}`}else e=Je(o.data);return{messages:o,content:e,parcelsWaybillIds:s}}),n(this,"onOpen",()=>{this.root.removeEventListener("inViewport",this.onOpen),this.loadData().then(this.onResponse).catch(this.onError)}),n(this,"onResponse",({messages:{data:e},content:t,parcelsWaybillIds:s})=>{this.setContent(t),this.setupListeners(),this.attachAnalytics(s),this.handleDisplayed(e)}),n(this,"onError",({status:e})=>{const t=401===e?Ye(this.props):(()=>{const e=ie("loading-messages-failed");return Ze({className:h,content:e})})();this.setContent(t)}),n(this,"setContent",e=>{this.content.innerHTML=e}),n(this,"handleDisplayed",({messages:e})=>{this.services&&this.services.get("opbox-notification-service").then(e=>{e.reset("inboxes")});const t=e.filter(e=>"CLICKED"!==e.status);t.length>0&&this.api.updateStatusToDisplayed(t.map(e=>e.tinkerbellId))}),n(this,"setupListeners",()=>{this.root.querySelectorAll('[data-role="message-group-toggle"]').forEach(e=>e.addEventListener("click",this.toggleGroupVisibility)),this.root.querySelectorAll('button[data-role="message-dropdown"]').forEach(e=>e.addEventListener("click",this.toggleDeleteMessageDropdown)),this.root.querySelectorAll('[data-role="action-delete"]').forEach(e=>e.addEventListener("click",this.singleMessageDeleteListener(e.dataset.idToDelete))),this.root.querySelectorAll('[data-role="action-delete-group"]').forEach(e=>e.addEventListener("click",this.groupMessageDeleteListener(e.dataset.idToDelete)));const e=this.root.querySelector('[data-role="show-parcels-notifications"]');e&&e.addEventListener("click",this.toggleParcelsNotifications)}),n(this,"toggleDeleteMessageDropdown",e=>{e.preventDefault();const t=e.currentTarget.parentElement.parentElement.querySelector('[data-role="message-actions-dropdown"]'),s=t.classList.contains(S);this.root.querySelectorAll('[data-role="message-actions-dropdown"]').forEach(this.hideActionsDropdown),s||(t.classList.add(S),t.querySelector('button[data-role="message-dropdown"]').classList.add(E))}),n(this,"toggleGroupVisibility",e=>{e.preventDefault();const t=e.currentTarget,s=t.parentElement;if(s){t.classList.toggle(B);const e=s.parentElement.querySelector('[data-role="message-group-content"]');e.classList.toggle(W),e.classList.toggle(G)}}),n(this,"toggleParcelsNotifications",()=>{const e=this.root.querySelector('[data-role="parcels-notifications"]');this.root.querySelector('[data-role="show-parcels-notifications"] > img').classList.toggle(he),e.classList.toggle(fe)}),this.window=e,this.api=t,this.root=s,this.content=s.querySelector('[data-role="inbox"]'),this.services=o,this.props=r}mount(){null!==(e=>{const t=document.cookie.split(/;\s*/);for(let s=t.length-1;s>=0;s-=1){const[e,o]=t[s].split("=").map(e=>decodeURIComponent(e));if("qeppo_login2"===e)return o}return null})()?this.root.addEventListener("inViewport",this.onOpen):(this.setContent(Ye(this.props)),new ut(this.root,this.window.location).mount())}groupMessageDeleteListener(e){return t=>{t.stopPropagation(),this.api.deleteGroup(e),this.deleteMessageListItem(t.target.closest(ht)),this.window.opbox.analytics.sendClickEvent({contextNode:this.root,label:"deleteMessageGroup",value:e})}}deleteMessageListItem(e){e.remove(),this.root.querySelectorAll('[data-role="message"]').length||(this.content.innerHTML=Fe())}singleMessageDeleteListener(e){return t=>{t.stopPropagation(),this.api.delete(e),this.deleteSingleMessage(t.target.closest('[data-role="message"]')),this.window.opbox.analytics.sendClickEvent({contextNode:this.root,label:"deleteSingleMessage",value:e})}}deleteSingleMessage(e){const t=e.parentNode,s=t.matches('[data-role="message-group-content"]'),o=1===t.childElementCount;s&&o&&this.removeGroupToggleControls(t),this.deleteMessageListItem(e)}removeGroupToggleControls(e){const t=e.parentNode.querySelector('[data-role="message-group-toggle"]');e.remove(),t.remove()}hideActionsDropdown(e){e.classList.remove(S),e.querySelector('button[data-role="message-dropdown"]').classList.remove(E)}attachAnalytics(e){const t=this.root.querySelector('[data-role="redirect-button"]'),s=this.root.querySelector('[data-role="inbox"]');this.root.querySelectorAll('[data-role="message"]').forEach(t=>{t.addEventListener("click",t=>{t.stopPropagation(),this.window.opbox.analytics.sendClickEvent({contextNode:t.target,label:"notificationClicked",customParams:{parcelsWaybillIds:e}})})}),t&&t.addEventListener("click",()=>{this.window.opbox.analytics.sendClickEvent({contextNode:t,label:"parcelsDetailsOpened",customParams:{parcelsWaybillIds:e}})}),s&&s.addEventListener("click",e=>{e.stopPropagation()})}}const vt={withCredentials:!0,headers:{Accept:"application/json","Content-type":"application/json"}},yt=Object.assign({},vt,{headers:{Accept:"application/vnd.allegro.internal.v1+json","Content-type":"application/vnd.allegro.internal.v1+json"}}),wt=Object.assign({},vt,{headers:Object.assign({},vt.headers,{"Content-type":"application/vnd.allegro.public.v2+json"})});class $t{constructor(e){const{opbox:{edge:t}}=e;this.edge=t}getMessages(){return this.edge.get("/inbox/messages",vt)}getPackegesStatuses(){return this.edge.get("/parcels-for-pickup",yt)}updateStatusToDisplayed(e){const t={tinkerbellIdEvents:e.map(e=>({tinkerbellId:e}))};this.edge.post("/inbox/events/displayed",t,wt)}delete(e){this.edge.delete("/inbox/messages/"+e,vt)}deleteGroup(e){this.edge.delete("/inbox/messages/group/"+e,vt)}}window.opbox.component.register({prototypeName:"allegro.user.inbox"},class{constructor({baseNode:e,services:t,props:s}){this.inbox=new ft(window,new $t(window),e,t,s)}onMount(){this.inbox.mount()}})}}));
//# sourceMappingURL=index.es6-pl-PL_85493fe4.js.map