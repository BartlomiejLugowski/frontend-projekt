(window.webpackJsonp_13850=window.webpackJsonp_13850||[]).push([[1],{t40z(e,t,o){o.r(t),o.d(t,"Notifications",()=>p);var i=o("rePB");const a={"pl-PL":{"Allegro.pl - wygodne i bezpieczne zakupy online, największy wybór ofert":[["",["Allegro.pl - wygodne i bezpieczne zakupy online, największy wybór ofert"]]],Kategorie:[["",["Kategorie"]]],Zaloguj:[["",["Zaloguj"]]],Wyloguj:[["",["Wyloguj"]]],"Moje Allegro":[["",["Moje Allegro"]]],Powiadomienia:[["",["Powiadomienia"]]],"Liczba powiadomień":[["",["Liczba powiadomień: {{notificationsCount}}"]]],"Rozwiń menu z wiadomościami":[["",["Rozwiń menu z wiadomościami"]]],"Rozwiń menu z powiadomieniami":[["",["Rozwiń menu z powiadomieniami"]]],"Kliknij, aby przejść do zakładki obserwowane.":[["",["Kliknij, aby przejść do zakładki obserwowane."]]],więcej:[["",["więcej"]]],"Halo odbiór!":[["",["Halo odbiór!"]]],"Czeka na Ciebie przesyłka":[["",["Czeka na Ciebie \n{{count}} przesyłka","Czekają na Ciebie \n{{count}} przesyłki","Czeka na Ciebie \n{{count}} przesyłek"]]]}},r=/({{[^}]+}}|{%[^%}]+%})/g,n=/({{[^}]+}})/g,s=/({%[^%}]+%})/g,c=/({{\s*|\s*}}|{%\s*|\s*%})/g;function l(e,t=""){if("string"==typeof e)throw Error("Translation has to be an array");return e.find(e=>e[0]===t)[1]}const d=(e,t,o)=>{const i=a["pl-PL"][e];if(!i)throw Error(`Missing translation for lang "pl-PL" and key "${e}"`);return t?((e,t,o)=>{let i=l(e,t.context);return parseInt(t.count,10)>=0?i=((e,t)=>{const o=1==(i=t)?0:i%10>=2&&i%10<=4&&(i%100<10||i%100>=20)?1:2;var i;return"boolean"!=typeof o?e[o]:e[o?1:0]})(i,t.count):[i]=i,((e,t,o)=>{if(o){let o=0;return e.split(r).map(i=>{if(i.match(s)){const a=t.formatters[o];if(a)return o+=1,a(i.replace(c,""));throw Error(`Missing translation formatter for "${e}"`)}return i.match(n)?t[i.replace(c,"")]:i})}const i=e.match(r);let a=0;return i?i.reduce((o,i)=>{const r=i.replace(c,"");if(i.match(s)){const n=t.formatters[a];if(n)return a+=1,o.replace(i,n(r));throw Error(`Missing translation formatter for "${e}"`)}return i.match(n)?o.replace(i,t[r]):o},e):e})(i,t,o)})(i,t,o):l(i)[0]};class p{constructor(e,t,o,a=window){Object(i.a)(this,"onUpdate",e=>{Object.keys(e).forEach(t=>{this.renderElement({notificationName:t,value:e[t]})}),((e,t,o)=>{const{parcelsToPickupIn24h:i,parcelsToPickupOver24h:a,parcelsChecksum:r,parcelsWaybillIds:n}=e,s=(e=>{return(e=>{const t=document.cookie.split("; ").find(e=>e.startsWith("parcelsChecksum="));return t?t.split("=")[1]:null})()!==e&&(t=e,document.cookie="parcelsChecksum="+t,!0);var t})(r);(i||a)&&(((e,t,o)=>{const i=e.querySelector('[data-role="package-message"]'),a=e.querySelector('[data-dropdown-id="inbox_dropdown"]');if(i){const e=e=>{e.stopPropagation(),t.opbox.analytics.sendClickEvent({contextNode:i,label:"popoverPackageMessageClickedDesktop",customParams:{parcelsWaybillIds:o}})};i.removeEventListener("click",e),i.addEventListener("click",e)}if(a){const e=()=>{"true"===a.firstChild.getAttribute("aria-expanded")&&t.opbox.analytics.sendClickEvent({contextNode:a,label:"tinkerbellClickedDesktop",customParams:{parcelsWaybillIds:o}})};a.removeEventListener("click",e),a.addEventListener("click",e),t.opbox.analytics.sendItemViewEvent({contextNode:a,label:"tinkerbellSeen",customParams:{parcelsWaybillIds:o}})}})(t,o,n),((e,t)=>{const o=t.querySelector('[data-role="package-count"]');o&&(o.textContent=d("Czeka na Ciebie przesyłka",{count:e}))})(i+a,t),setTimeout(()=>((e,t)=>{const o=t.querySelector('[data-role="package-message"]'),i=t.querySelector('[data-notification-tag="inboxes"]'),a=t.querySelector('[data-role="bell-icon"]'),r=t.querySelector('[data-role="pack-icon"]');a&&r&&o&&i&&(e&&o.classList.toggle("_13850_DSFDu"),i.classList.toggle("_13850_UsQBq"),a.classList.toggle("_13850_UsQBq"),r.classList.toggle("_13850_DSFDu"))})(s,t),4e3))})(e,this.baseNode,this.targetWindow)}),Object(i.a)(this,"getBadgesCount",(e,t)=>t.reduce((t,o)=>t+(e[o]||0),0)),Object(i.a)(this,"formatByThreshold",(e,t)=>e<t?""+e:t-1+"+"),this.targetWindow=a,this.services=t,this.baseNode=e,this.props=o}initialize(){this.register()}register(){this.services.get("opbox-notification-service").then(e=>{e.getNotifications(e=>{const t=this.getBadgesCount(e,this.props.subscribedNotificationBadges);this.onUpdate(Object.assign({},e,{userDropdownTotal:t}))})})}renderElement({notificationName:e,value:t}){const o=this.baseNode.querySelector(`[data-notification-tag="${e}"]`);if(o)if(0===t)o.textContent="",o.setAttribute("aria-label","");else{const e=this.formatByThreshold(t,100);o.textContent=e,o.setAttribute("aria-label",d("Liczba powiadomień",{notificationsCount:e}))}}}}}]);
//# sourceMappingURL=notifications.es6-pl-PL_6e648d36.js.map